import re
from Crypto.Util.number import *

hexn = "00F19866D888741A853B88DE2B3970A4E2038BB42AD57D2B167542D248D00358E4C7DBDFE0505744EC2DA54B68DA271CE805063F89C1CFB764ADE045B7C5BFD82AED786F7B359F047A4208FD9652847441171005A9492EEEECE26B8837A3E4A0CBFCFB172F714E461F6889FC64E55F27761A39FAF7205F8CF03E3BFC257132AA54E3F3BE0CF6E90853310E8A77B7840EBB89D4A5C99596667CAE1A3F131E30C7702921FCEA639CCCDCBF26952CCA4CB71E5B263899A44FD0CD010D652EAF2E65B9A2F4329D8BD0D3637E970970356F833B3FC713594606A1F673F0677B8750C13054FE7DFA0978219217FF27C1DC9C847EC9B1D930ABA02D923912C5B308CC7D47"
hexe = "010001"
hexd = "02BB4B66655C92B430F12239F0E35229F00A53562CA5C6A7F159791133B0E5FF68371737ED109F89E0163F5D07226C143F824B939E2A60137657D3D1F91D6B2F491214889B199A2E5BB2C8533BC99D9AE2CCDE93846D506C433F1E022B0B39BA34B90E110E41E94F0F9A87CD083EE42E54AB9527D828DC6A16FA0CA6CBB9DBED262ADF514A185B5E3DFD107F19E17A6B7DE224244BC894594E1DEBA84B2036B9A53E6247C830A1514A83C82699BDFBE57323DE76A1D61030ACEC70EAABEF8CAEE47D8C8D380E367F4EC932D08500C98AD8C1A26409468BA7DB3779D3EF797275A9A64850006366FAB8536A37DE7837842CA565E29430F983334E975BD55BD789"
hexp = "00F5E7A19F5C36CA6B6167FCB981C5D2F369C42B522F4B0D025E9F68BE042DC3E23C0603DDF367F5972586391DCB16C26CF7252E45DA02AA158C2447B6388AD31EB2B24F0F4DBCAC08F3C5CAE22059F4FAA889E8083AF054FD7DD93DB29512468E2CF6EB96FC4EF2F680339F81C01ADE696187AD933434680235F45A1EA84BA345"
hexq = "00FB837AB023A0CECCBD946BD430B4CD3D234CEDB4933FE729FF98A05D1F5D3C42F7CF186E0BE005F0531F9C87F39BA6CF6F4B748FCCD3302284124845622DE55E12FF8AD9006F2B51CEB3ABD2E54D55B85E6A07D8961D3BE7BB3E884DD9EDA8E3C27A48B3A6C2729FFA8E31C856846ADF1C4E9B8EEE1315FFAA0EA4C84BE3011B"

n = int(hexn, 16)
e = int(hexe, 16)
d = int(hexd, 16)
p = int(hexp, 16)
q = int(hexq, 16)

with open("flag.txt.enc", "rb") as file:
 ct = bytes_to_long(file.read())


print("CT: ", ct)
print("d: ", d)
print("n: ", n)
m = pow(ct,d, n)
decoded = long_to_bytes(m)

print(f"Decrypted Cipher Text as Flag:{decoded}")